<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>To-Do App</title>
  <style>
    * { box-sizing: border-box; }
    body { 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; 
      background: skyblue;
      margin: 0; 
    }
    .container { 
      max-width: 760px; 
      margin: 40px auto; 
      background: #fff; 
      padding: 24px; 
      border-radius: 16px; 
      box-shadow: 0 10px 30px rgba(0,0,0,.06); 
    }
    h1 { margin: 0 0 16px; font-weight: 800; }

    #todo-form { 
      display: grid; 
      grid-template-columns: 1fr 1fr 180px 140px; 
      gap: 10px; 
      margin-bottom: 16px; 
    }
    #todo-form input, #todo-form button { 
      padding: 10px 12px; 
      border: 1px solid #e5e7eb; 
      border-radius: 10px; 
    }
    #todo-form button { 
      background: purple; 
      color: #fff; 
      border: none; 
      cursor: pointer; 
    }
    #todo-form button:hover { opacity: .95; }

    .toolbar { display: flex; gap: 10px; margin: 12px 0 16px; }
    .toolbar input, .toolbar select { flex: 1; padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 10px; }

    #todo-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 10px; }
    .todo { display: grid; grid-template-columns: 28px 1fr auto; align-items: start; gap: 12px; padding: 14px; border: 1px solid #e5e7eb; border-radius: 12px; }
    .todo.completed { background: #f9fafb; opacity: .9; }
    .todo .title { font-weight: 700; }
    .todo .meta { color: #6b7280; font-size: 13px; }
    .todo .actions { display: flex; gap: 8px; }

    .todo button { 
      border: none; 
      padding: 8px 10px; 
      border-radius: 8px; 
      cursor: pointer; 
      color: white;
    }
    .todo .edit-btn { background: green; }
    .todo .edit-btn:hover { background: darkgreen; }
    .todo .delete-btn { background: red; }
    .todo .delete-btn:hover { background: darkred; }

    .badge { font-size: 11px; padding: 2px 8px; border-radius: 999px; border: 1px solid #e5e7eb; }
    .badge.overdue { border-color: #fecaca; color: #991b1b; background: #fff1f2; }
  </style>
</head>
<body>
  <div class="container">
    <h1>To-Do List</h1>
    <form id="todo-form">
      <input type="text" id="title" placeholder="Title" required>
      <input type="text" id="description" placeholder="Description">
      <input type="date" id="dueDate">
      <button type="submit" class="add">Add Task</button>
    </form>

    <div style="display:flex;gap:10px;margin-bottom:10px;">
      <input type="text" id="search" placeholder="Search...">
      <select id="filter">
        <option value="all">All</option>
        <option value="active">Active</option>
        <option value="completed">Completed</option>
        <option value="overdue">Overdue</option>
      </select>
      <span id="count"></span>
    </div>
    <ul id="todo-list"></ul>
  </div>

<script>
let todos = JSON.parse(localStorage.getItem('todos') || '[]');

const listEl = document.getElementById('todo-list');
const formEl = document.getElementById('todo-form');
const titleEl = document.getElementById('title');
const descEl = document.getElementById('description');
const dueEl = document.getElementById('dueDate');
const filterEl = document.getElementById('filter');
const searchEl = document.getElementById('search');
const countEl = document.getElementById('count');

function saveTodos() {
  localStorage.setItem('todos', JSON.stringify(todos));
}

function isOverdue(todo) {
  if (!todo.dueDate) return false;
  const today = new Date();
  const due = new Date(todo.dueDate);
  return !todo.completed && due.setHours(0,0,0,0) < today.setHours(0,0,0,0);
}

function render() {
  const query = searchEl.value.toLowerCase();
  const filter = filterEl.value;

  let visible = todos.filter(t =>
    t.title.toLowerCase().includes(query) ||
    (t.description || '').toLowerCase().includes(query)
  );

  if (filter === 'active') visible = visible.filter(t => !t.completed);
  if (filter === 'completed') visible = visible.filter(t => t.completed);
  if (filter === 'overdue') visible = visible.filter(isOverdue);

  countEl.textContent = `${visible.length} item${visible.length !== 1 ? 's' : ''}`;

  listEl.innerHTML = '';
  visible.forEach(t => listEl.appendChild(renderItem(t)));
}

function renderItem(todo) {
  const li = document.createElement('li');
  li.className = `todo ${todo.completed ? 'completed' : ''}`;

  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.checked = todo.completed;
  checkbox.addEventListener('change', () => {
    todo.completed = !todo.completed;
    saveTodos();
    render();
  });

  const body = document.createElement('div');
  const title = document.createElement('div');
  title.className = 'title';
  title.textContent = todo.title;

  const meta = document.createElement('div');
  meta.className = 'meta';
  const parts = [];
  if (todo.description) parts.push(todo.description);
  if (todo.dueDate) parts.push(`Due: ${new Date(todo.dueDate).toLocaleDateString()}`);
  parts.push(`Created: ${new Date(todo.createdAt).toLocaleString()}`);
  meta.innerHTML = parts.join(' â€¢ ');

  const badge = document.createElement('span');
  if (isOverdue(todo)) { badge.className = 'badge overdue'; badge.textContent = 'Overdue'; }

  body.appendChild(title);
  body.appendChild(meta);
  if (badge.textContent) body.appendChild(badge);

  const actions = document.createElement('div');
  actions.className = 'actions';

  const editBtn = document.createElement('button');
  editBtn.textContent = 'Edit';
  editBtn.className = 'edit-btn';
  editBtn.addEventListener('click', () => {
    const newTitle = prompt('Edit title', todo.title);
    if (newTitle === null) return;
    const newDesc = prompt('Edit description', todo.description);
    const newDue = prompt('Edit due date (YYYY-MM-DD)', todo.dueDate || '');
    todo.title = newTitle;
    todo.description = newDesc;
    todo.dueDate = newDue;
    saveTodos();
    render();
  });

  const delBtn = document.createElement('button');
  delBtn.textContent = 'Delete';
  delBtn.className = 'delete-btn';
  delBtn.addEventListener('click', () => {
    todos = todos.filter(t => t !== todo);
    saveTodos();
    render();
  });

  actions.appendChild(editBtn);
  actions.appendChild(delBtn);

  li.appendChild(checkbox);
  li.appendChild(body);
  li.appendChild(actions);
  return li;
}

formEl.addEventListener('submit', e => {
  e.preventDefault();
  todos.push({
    id: Date.now(),
    title: titleEl.value,
    description: descEl.value,
    dueDate: dueEl.value || null,
    completed: false,
    createdAt: new Date().toISOString()
  });
  saveTodos();
  formEl.reset();
  render();
});

searchEl.addEventListener('input', render);
filterEl.addEventListener('change', render);

render();
</script>
</body>
</html>
